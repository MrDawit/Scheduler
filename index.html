<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery.js"></script>
    <link rel="stylesheet" type="text/css" href="./assets/style.css" />
    <title>Scheduler</title>
</head>

<body>
    <!-- add scroll -->
    <header id="heading">
        <h1>Scheduler</h1>
        <nav id="headerDateAndTime">
        </nav>
    </header>
    <main>
        <!-- <input type="text" name="user">
       <button id="userName">Press to Display</button> -->
        <table>
            <tr>
                <th id="timeCol">Time</th>
                <th id="taskCol">Task</th>
                <th id="saveCol"></th>
            </tr>
        </table>
    </main>
    <!-- signiture footer -->
    <footer>
        <div id=text>created by SD_WORKS</div>
        <div id=image>
            &copy;<img src="./favicon.ico" alt="juju image">9/20
        </div>
    </footer>
    <!-- link to moment.js -->
    <script src="./lib/moment/moment.js"></script>


    <!-- js for the scheduler header and main elements -->
    <script>
        var saveBut;
        var textareaRevamp;
        var textareaID;
        var i = 0;
        var a = 0;
        var dateFormat = moment().format("MMM/DD/YYYY dddd");
        var timeFormat = moment().format("hh:mm A");
        var checkTime = moment().format("H");
        var checkLocStorage = {};
        //time stamp
        $("#headerDateAndTime").append(dateFormat + "<br>");
        $("#headerDateAndTime").append(timeFormat);
        //adding to checkLocStorage object
        for (a = 8; a < 18; a++) {
            checkLocStorage[a] = localStorage.getItem("taskText" + a + "key");
        };
        //adding timeblocks to table and using this for loop to set color to timeblocks comparing the hour of the day 
        for (i = 8; i < 18; i++) {
            $("table").append("<tr><td id='timeCol'>" + i + ":00</td><td class='taskCol' id='taskTD_id" + i + "'><textarea class='taskText' id='taskText" + i + "' placeholder='Place Tasks Here'></textarea></td><td id='saveCol'><button id='saveBtn'>Save</button></td></tr>");


            if (checkLocStorage[i] !== null || undefined) {
                console.log("This row is not null or undefined");
                console.log(i + ": " + checkLocStorage[i]);
                $("#taskTD_id" + i).html(checkLocStorage[i]);
            };
            //past timeblock
            if (checkTime > i) {
                $("#taskTD_id" + i).add("#taskText" + i).attr("style", "background:red; opacity:80%;color:black");
            };
            //present timeblock
            if (checkTime == i) {
                $("#taskTD_id" + i).add("#taskText" + i).attr("style", "background:yellow; opacity:90%;color:red");
            };
            //future timeblock
            if (checkTime < i) {
                $("#taskTD_id" + i).add("#taskText" + i).attr("style", "background:grey; opacity:100%;color:black");
            };
        };

        //after clicking save button, function replaces textarea with saved localStorage text
        $("button").click(function () {
            saveBut = $(this).closest("tr").find(".taskText").val().trim();
            textareaRevamp = $(this).closest("tr").find(".taskCol");
            textareaID = $(this).closest("tr").find(".taskText").attr("id");
            //this statement along with the .trim() stops blank answers from being saved
            if (saveBut === "") {
                return;
            };
            localStorage.setItem(textareaID + "key", saveBut);
            textareaRevamp.text(localStorage.getItem(textareaID + "key"));
        });

            //after scheduler works, change away from military time
            //use an input box to specify caption above table. save this data to local storage, then use js to place it in the table using prepend (all the rows)
            //         $("#userName").click(function(){
            // var Name = $("input").val();
            // //make if statement clearing the input and button on refresh if there is already a name for the scheduler in local storage
            //         $("table").prepend();
    </script>
</body>

</html>